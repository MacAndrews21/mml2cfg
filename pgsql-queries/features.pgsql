select way, religion,coalesce (aeroway, amenity, landuse, leisure, military, "natural", power, tourism, highway) as feature from (select way,('aeroway_' || (case when aeroway in ('apron', 'aerodrome') then aeroway else null end)) as aeroway,('amenity_' || (case when amenity in ('parking', 'university', 'college', 'school', 'hospital', 'kindergarten', 'grave_yard') then amenity else null end)) as amenity,('landuse_' || (case when landuse in ('quarry', 'vineyard', 'orchard', 'cemetery', 'grave_yard', 'residential', 'garages', 'field', 'meadow', 'grass', 'allotments', 'forest', 'farmyard', 'farm', 'farmland', 'recreation_ground', 'conservation', 'village_green', 'retail', 'industrial', 'railway', 'commercial', 'brownfield', 'landfill', 'greenfield', 'construction') then landuse else null end)) as landuse,('leisure_' || (case when leisure in ('swimming_pool', 'playground', 'park', 'recreation_ground', 'common', 'garden', 'golf_course', 'picnic_table') then leisure else null end)) as leisure,('military_' || (case when military in ('barracks', 'danger_area') then military else null end)) as military,('natural_' || (case when "natural" in ('field','beach','desert','heath','mud','grassland','wood','sand','scrub') then "natural" else null end)) as "natural",('power_' || (case when power in ('station','sub_station','substation','generator') then power else null end)) as power,('tourism_' || (case when  tourism in ('attraction', 'camp_site', 'caravan_site', 'picnic_site', 'zoo') then tourism else null end)) as tourism,('highway_' || (case when highway in ('services', 'rest_area') then highway else null end)) as highway,case when religion in ('christian','jewish') then religion else 'INT-generic'::text end as religion       from planet_osm_polygon       where landuse is not null          or leisure is not null          or aeroway in ('apron','aerodrome')          or amenity in ('parking','university','college','school','hospital','kindergarten','grave_yard')          or military in ('barracks','danger_area')          or "natural" in ('field','beach','desert','heath','mud','grassland','wood','sand','scrub')          or power in ('station','sub_station','generator')          or tourism in ('attraction','camp_site','caravan_site','picnic_site','zoo')          or highway in ('services','rest_area')       order by z_order,way_area desc      ) as landcover

